"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["scanning"],{42870:(e,t,r)=>{function n(){document.removeEventListener("turbo:load",n);let e=document.querySelector('[data-target="secret-scanning-filter.clearButton"]');if(null===e)return;let t=e?.hidden;if(t){let e=document.querySelectorAll(".js-change-open-close-state"),t=e[e.length-2];t?.focus();return}document.title=document.title.concat(" (filters applied)"),e.focus()}(0,r(59753).on)("click",".js-change-open-close-state",function(){document.addEventListener("turbo:load",n)})},99049:(e,t,r)=>{r(70883);var n=r(59753),o=r(9238),s=r(69567),i=r(46263),l=r(36071),d=r(5223),a=r(54868),u=r(48683);function c(e){return e.currentTarget}function m(e){e.textContent=e.getAttribute("data-disable-with")||"",e.disabled=!0}function p(e){e.textContent=e.getAttribute("data-original-text")||"",e.disabled=!1}function f(){return document.querySelector(".js-custom-secret-scanning-pattern-form")}(0,l.N7)(".js-add-secret-format-button",{add(){window.postProcessingExpressionCount=0;let e=document.querySelector(".js-post-processing-expression-count");e&&e.textContent&&(window.postProcessingExpressionCount=parseInt(e.textContent))}}),(0,n.on)("click",".js-add-secret-format-button",e=>{let t=e.currentTarget;if(t&&window.postProcessingExpressionCount<b()){let e=document.querySelectorAll(".js-additional-secret-format");if(!e)return;for(let r of e)if(r.classList.contains("has-removed-contents")){r.classList.toggle("has-removed-contents",!1),window.postProcessingExpressionCount++,window.postProcessingExpressionCount===b()&&(t.hidden=!0);break}}}),(0,n.on)("click",".js-remove-secret-format-button",e=>{let t=document.querySelector(".js-add-secret-format-button");if(!t)return;let r=e.currentTarget;if(!r)return;let n=r.closest(".js-additional-secret-format");if(!n)return;n.classList.toggle("has-removed-contents",!0);let o=n.getElementsByClassName("js-post-processing-input")[0];o.value="";let s=Array.from(n.getElementsByClassName("js-post-processing-input-rule")),i=n.getElementsByClassName("errored")[0];for(let e of(i&&i.classList.toggle("errored",!1),s))document.getElementById(`${e.id}_hidden`)?.remove();document.getElementById(`${o.id}_hidden`)?.remove(),y(window.codeEditor.getValue()),window.postProcessingExpressionCount--,window.postProcessingExpressionCount<b()&&(t.hidden=!1)}),(0,l.N7)(".js-test-code",{async add(){let e=document.querySelector(".js-test-code"),t=e.clientHeight,n=await r.e("vendors-node_modules_codemirror_lib_codemirror_js").then(r.t.bind(r,4631,23));if(window.codeEditor=n.default.fromTextArea(e,{lineNumbers:!1,lineWrapping:!0,mode:"text/x-yaml",inputStyle:"contenteditable",value:e.value,lineSeparator:"\r\n",theme:"github-light"}),0!==t){let e=document.querySelector(".CodeMirror");e&&(e.style.height=`${t}px`,e.style.border="1px solid #e1e4e8",e.style.borderRadius="6px")}window.codeEditor.save();let o=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!o)return;let s=y;o.hasAttribute("data-source-is-readonly")&&(s=C),window.codeEditor.on("change",()=>{s(window.codeEditor.getValue())})}}),(0,n.on)("change",".js-post-processing-input-rule",async function(){/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&window.codeEditor&&y(window.codeEditor.getValue())}),(0,o.q6)(".js-custom-secret-scanning-pattern-form *",async function(){window.codeEditor&&y(window.codeEditor.getValue())}),(0,n.on)("click",".js-repo-selector-dialog-summary-button.disabled",e=>{e.preventDefault()}),(0,o.q6)(".js-description-input",async function(){let e=document.querySelector(".js-description-input");if(!e)return;v(e.parentElement);let t=e.getAttribute("aria-describedby");document.querySelector(`#${t}`)?.remove()}),(0,n.on)("click",".js-generated-expression-use",async e=>{let t=document.querySelector(".js-secret-format");if(!t)return;let r=document.querySelector(".js-generate-expression-examples");if(!r)return;let n=e.currentTarget,o=n.attributes.getNamedItem("for")?.value,s=document.getElementById(o);s&&(t.value=s.textContent,window.codeEditor.setValue(r.value.replaceAll(`
`," ")),t.focus())}),(0,n.on)("click",".js-generate-expressions-form-submit-button",async e=>{let t;e.preventDefault();let r=document.querySelector(".js-description-input");if(!r)return;if(""===r.value){w(r.parentElement),x(r,"description_empty","Field cannot be blank");return}let n=document.querySelector(".js-generated-expressions-section");if(!n)return;let o=document.querySelector(".js-generated-expressions-error-section");if(!o)return;let s=document.querySelector(".js-generated-expressions-warning-section");if(!s)return;n.hidden=!0,o.hidden=!0,s.hidden=!0;let i=document.querySelectorAll(".js-generated-expression-box");if(!i)return;for(let e=0;e<i.length;e++)i[e].toggleAttribute("hidden",!0);let l=c(e);if(!l)return;m(l);let d=document.querySelector(".js-generate-expressions-form");if(d){try{let e=await fetch(d.action,{method:d.method,body:new FormData(d),headers:{Accept:"application/json"}});if((t=await e.json()).error_msg){t=await e.json(),o.textContent=t.error_msg,o.hidden=!1,p(l);return}}catch(e){o.textContent="Something went wrong. Please try again later.",o.hidden=!1,p(l);return}if(t&&t.generated_expressions){if(0===t.generated_expressions.length)s.textContent="No expressions were generated. Please retry with a different description.",s.hidden=!1;else{let e=document.querySelectorAll(".js-generated-expression");if(!e)return;let r=document.querySelectorAll(".js-generated-expression-explanation");if(!r)return;for(let n=0;n<t.generated_expressions.length;n++)e[n].textContent=t.generated_expressions[n].regex,r[n].textContent=t.generated_expressions[n].explanation;for(let n=t.generated_expressions.length;n<e.length;n++)e[n].textContent="",r[n].textContent="";for(let e=0;e<t.generated_expressions.length;e++)i[e].removeAttribute("hidden");o.hidden=!0,s.hidden=!0,n.hidden=!1}}p(l)}}),(0,n.on)("click",".js-save-and-dry-run-button, .js-custom-pattern-submit-button, .js-org-repo-selector-dialog-dry-run-button",e=>{e.preventDefault();let t=c(e);if(!t)return;m(t);let r=f();r&&((t.className.includes("js-save-and-dry-run-button")||t.className.includes("js-org-repo-selector-dialog-dry-run-button"))&&g(r,"submit_type","save_and_dry_run"),(0,n.f)(r,"submit"))});let g=(e,t,r)=>{let n=document.createElement("input");n.type="hidden",n.name=t,n.id=`${t}_hidden`,n.value=r,e.appendChild(n),n.required=!0},y=(0,i.D)(function(e){let t=document.querySelector(".js-custom-pattern-submit-button"),r=document.querySelector(".js-save-and-dry-run-button"),n=document.querySelector(".js-repo-selector-dialog-summary-button"),o=document.querySelector(".js-update-pattern-info"),s=document.querySelector(".js-test-pattern-matches");if(s){if(0===e.length){let e=document.querySelector(".js-dry-run-status");if(!e)return;e.textContent?.toLowerCase()==="queued"||e.textContent?.toLowerCase()==="inprogress"||t?.setAttribute("disabled","true"),r?.setAttribute("disabled","true"),n?.classList.add("disabled"),s.textContent=""}else{window.codeEditor.save();let e=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(e instanceof HTMLFormElement))return;let i=f();if(!i)return;for(let t of i.elements)if(t instanceof HTMLInputElement&&t.name&&("text"===t.type||"radio"===t.type&&t.checked)){let r=document.getElementById(`${t.name}_hidden`);null!==r&&r.remove(),g(e,t.name,t.value)}S(e,h(i,t,r,n,o),_(s))}}},300),_=e=>t=>{if(0===t.length)e.textContent=" - No matches";else if(1===t.length)e.textContent=" - 1 match";else{let r=[];for(let e of t)r.push(JSON.stringify(e));let n=new Set(r),o=[...n];e.textContent=` - ${o.length} matches`}},h=(e,t,r,n,o)=>s=>{if(function(e){let t=document.querySelector(".js-error-banner");for(let r of(t.hidden=!0,e.getElementsByTagName("input")))if(r.parentElement?.classList.contains("errored")){v(r.parentElement);let e=r.getAttribute("aria-describedby");document.querySelector(`#${e}`)?.remove()}}(e),s?.message){if(t?.setAttribute("disabled","true"),r?.setAttribute("disabled","true"),n?.classList.add("disabled"),o)o.hidden=!0;else if(s?.error_type==="START_DELIMITER"||s?.error_type==="END_DELIMITER"||s?.error_type==="MUST_MATCH"||s?.error_type==="MUST_NOT_MATCH"){let e=document.querySelector(".js-more-options.js-details-container");e&&(0,u.O4)(e)}return function(e,t){if("MUST_MATCH"===t.error_type||"MUST_NOT_MATCH"===t.error_type){let r=0,n=e.getElementsByClassName("js-additional-secret-format");for(let e of n){if(r>(t.error_index||0))return;let n=e.getElementsByTagName("input"),o=[...n].filter(e=>e.checked),s=o&&o[0]?.value.toUpperCase(),i=s===t.error_type&&r===t.error_index,l=e.getElementsByTagName("input"),d=[...l].filter(e=>"text"===e.type);if(!d||0===d.length)continue;let a=d[0];if(""!==a.value){if(i){let e=a.id;a&&a.parentElement&&(w(a.parentElement),x(a,e,t.message,!0,"mt-6"));return}s===t.error_type&&r++}}}else{let e=j[t.error_type],r=document.querySelector(`#${e}`);r&&r.parentElement&&(w(r.parentElement),x(r,e,t.message,!0))}}(e,s),!1}{let e=document.querySelector(".js-mode");if(!e)return!1;let s=document.querySelector(".js-dry-run-status");return!!s&&(s.textContent?.toLowerCase()!=="cancelled"&&s.textContent?.toLowerCase()!=="skipped"&&(e.textContent?.toLowerCase()==="unpublished"||e.textContent?.toLowerCase()==="published")||t?.removeAttribute("disabled"),n?.classList.remove("disabled"),r?.removeAttribute("disabled"),o&&(o.hidden=!1),!0)}};function b(){let e=document.querySelector(".js-post-processing-expression-max-count");if(!e)return 10;let t=e.textContent;return t?parseInt(t):10}function w(e){e?.classList.add("form-group","errored","my-0")}function v(e){e?.classList.remove("form-group","errored","my-0")}function x(e,t,r,n=!1,o="mt-4"){let s=document.createElement("p"),i=`${t}_error_message`;s.classList.add("note","error"),n&&s.classList.add(o),s.id=i,s.textContent=r,e.setAttribute("aria-describedby",i),e.insertAdjacentElement("afterend",s)}function E(){if(!window.codeEditor)return;let e=window.codeEditor.posFromIndex(0),t=window.codeEditor.posFromIndex(window.codeEditor.getValue().length);for(let r of window.codeEditor.findMarks(e,t))r.clear()}let j={NONE:"",CONFIG_LOAD:"secret_format",COMPILE_DB:"secret_format",START_DELIMITER:"before_secret",END_DELIMITER:"after_secret",DISPLAY_NAME:"display_name",DB_SIZE:"secret_format",DB_SIZE_CALCULATION:"secret_format"};async function S(e,t,r){let n;try{let t=await fetch(e.action,{method:e.method,body:new FormData(e),headers:{Accept:"application/json"}});t.ok&&(n=await t.json())}catch(e){}if(n){if(t(n.error)){if(n.has_matches){let e=JSON.parse(n.matches);for(let t of(E(),r(e),e))!function(e,t,r){let n=e.getValue();if(t=(0,a.yb)(n,t),r=(0,a.yb)(n,r),-1===t||-1===r)return;let o=e.posFromIndex(t),s=e.posFromIndex(r);e.markText(o,s,{className:"text-bold hx_keyword-hl rounded-2 d-inline-block"})}(window.codeEditor,t.start,t.end)}else r([]),E()}!function(e){let t=document.querySelector(".js-wildcards-warning");t&&(t.hidden=!e)}(n.has_wildcard_warning)}}let C=(0,i.D)(function(e){let t=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(t instanceof HTMLFormElement))return;let r=document.querySelector(".js-test-pattern-matches");if(r){if(0===e.length)r.textContent="";else{if(!window.codeEditor)return;window.codeEditor.save(),S(t,()=>!0,_(r))}}},300);async function q(e){let t=e.currentTarget;e.preventDefault(),N(t,parseInt(t.remove_repo_id.value),!1)}async function A(e,t=!1){let r=document.getElementById("selected_repo_ids");if(!r)return;let n=JSON.parse(r.value),o=new Set(n);o.clear(),r.value=JSON.stringify(Array.from(o));let i=document.querySelector(".js-org-repo-selector-dialog-dry-run-button");if(!i)return;t?i.removeAttribute("disabled"):i.setAttribute("disabled","true");let l=new FormData(e);l.append("selected_repo_ids",r.value);let a=await fetch(e.action,{method:e.method,body:l,headers:{Accept:"text/fragment+html"}});if(a.status>=400){let e=document.querySelector("template.js-flash-template");e.after(new s.R(e,{className:"flash-error",message:"An unknown error occurred."}))}else if(!t){let e=document.querySelector(".js-dry-run-selected-repos"),t=(0,d.r)(document,await a.text());e.replaceWith(t)}}async function N(e,t,r){let n=document.getElementById("selected_repo_ids");if(!n)return;let o=document.querySelector(".js-org-repo-selector-dialog-dry-run-button");if(!o)return;let i=JSON.parse(n.value),l=new Set(i);r?l.size<function(){let e=document.querySelector(".js-dry-run-selected-repos-max-count");if(!e)return 10;let t=e.textContent;return t?parseInt(t):10}()&&l.add(t):l.delete(t),n.value=JSON.stringify(Array.from(l)),l.size>0?o.removeAttribute("disabled"):o.setAttribute("disabled","true");let a=new FormData(e);a.append("selected_repo_ids",n.value);let u=await fetch(e.action,{method:e.method,body:a,headers:{Accept:"text/fragment+html"}});if(u.status>=400){let e=document.querySelector("template.js-flash-template");e.after(new s.R(e,{className:"flash-error",message:"An unknown error occurred."}))}else{let e=document.querySelector(".js-dry-run-selected-repos"),t=(0,d.r)(document,await u.text());e.replaceWith(t)}}(0,n.on)("click",".js-remove-dry-run-repo-form",q),(0,n.on)("auto-complete-change",".js-dry-run-repo-autocomplete",function(e){let t=e.target;if(!t.value)return;if(t.value.includes("No repositories found.")){t.value="";return}let r=t.closest("form");N(r,parseInt(r.repo_id.value),!0),t.value=""}),(0,n.on)("click",".js-clear-selected-repositories-button",function(){let e=document.querySelector(".js-add-dry-run-repo-form");e&&A(e)}),(0,l.N7)('input[type="radio"][name="dry_run_repo_selection"]',e=>{let t=document.querySelector(".js-dry-run-repo-selection-component");t&&e&&!0===e.checked&&("all_repos"===e.value?t.hidden=!0:"selected_repos"===e.value&&(t.hidden=!1))}),(0,n.on)("click",'input[type="radio"][name="dry_run_repo_selection"]',function(e){let t=e.currentTarget,r=document.querySelector(".js-dry-run-repo-selection-component");if(r){if("all_repos"===t.value){r.hidden=!0;let e=r.querySelector("form");if(!e)return;A(e,!0)}else if("selected_repos"===t.value){r.hidden=!1;let e=document.querySelector(".js-org-repo-selector-dialog-dry-run-button");if(!e)return;let t=document.getElementById("selected_repo_ids");if(!t)return;r.children[1].childElementCount<=1?e.setAttribute("disabled","true"):e.removeAttribute("disabled")}}}),(0,o.w4)("keydown",".js-dry-run-repo-autocomplete-input",function(e){"Enter"===e.key&&e.preventDefault()}),r(42870)},54868:(e,t,r)=>{function n(e){let t=e.split("\u200D"),r=0;for(let e of t){let t=Array.from(e.split(/[\ufe00-\ufe0f]/).join("")).length;r+=t}return r/t.length}function o(e,t,r,n=!0){let o=e.value.substring(0,e.selectionEnd||0),s=e.value.substring(e.selectionEnd||0);return l(e,(o=o.replace(t,r))+(s=s.replace(t,r)),o.length,n),r}function s(e,t,r){if(null===e.selectionStart||null===e.selectionEnd)return o(e,t,r);let n=e.value.substring(0,e.selectionStart),s=e.value.substring(e.selectionEnd);return l(e,n+r+s,n.length),r}function i(e,t,r={}){let n=e.selectionEnd||0,o=e.value.substring(0,n),s=e.value.substring(n),i=""===e.value||o.match(/\n$/)?"":"\n",l=r.appendNewline?"\n":"",d=i+t+l;e.value=o+d+s;let a=n+d.length;return e.selectionStart=a,e.selectionEnd=a,e.dispatchEvent(new CustomEvent("change",{bubbles:!0,cancelable:!1})),e.focus(),d}function l(e,t,r,n=!0){e.value=t,n&&(e.selectionStart=r,e.selectionEnd=r),e.dispatchEvent(new CustomEvent("change",{bubbles:!0,cancelable:!1}))}function d(e,t){let r=[...e],n=new TextEncoder,o=new Uint8Array(4);for(let e=0;e<r.length;e++){let s=r[e],{written:i,read:l}=n.encodeInto(s,o);if(!i||!l)return -1;let d=i-l;if(0!==d&&(e<t&&(t-=d),e>=t))break}return t}r.d(t,{Om:()=>i,lp:()=>o,rq:()=>n,t4:()=>s,yb:()=>d})}},e=>{var t=t=>e(e.s=t);e.O(0,["vendors-node_modules_dompurify_dist_purify_js","vendors-node_modules_stacktrace-parser_dist_stack-trace-parser_esm_js-node_modules_github_bro-a4c183","vendors-node_modules_github_selector-observer_dist_index_esm_js","vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_delegated-events_dist_in-b7c06a","ui_packages_failbot_failbot_ts","app_assets_modules_github_behaviors_details_ts-app_assets_modules_github_onfocus_ts-app_asset-d34eef"],()=>t(99049)),e.O()}]);
//# sourceMappingURL=scanning-9ca292cc7f19.js.map